<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Game</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
body{background:#121212;color:#f2f2f2;font-family:system-ui;text-align:center;padding:16px}
.piles{display:grid;grid-template-columns:repeat(2,150px);gap:14px;justify-content:center;margin:16px 0}
.pile{background:#1e1e1e;border:2px solid #555;border-radius:16px;padding:14px;position:relative}
.ping{position:absolute;top:-12px;right:-12px;font-size:26px}
.ping.have{color:#4caf50}
.ping.dont{color:#ff5252}

#pingbar{display:flex;justify-content:center;gap:10px;margin:10px}
.pingbtn{padding:12px 16px;border-radius:14px;background:#2b2b2b;cursor:grab}

.card{display:inline-block;background:#2c2c2c;padding:14px 18px;margin:8px;border-radius:16px}
</style>
</head>

<body>

<h1>The Game ğŸƒ</h1>

<div id="pingbar">
  <div class="pingbtn" draggable="true" data-type="have">ğŸ‘€ Ich hab was</div>
  <div class="pingbtn" draggable="true" data-type="dont">ğŸš« Bitte nicht</div>
</div>

<div class="piles" id="piles"></div>

<script>
const socket = io("https://the-game-server-h9br.onrender.com");
let state=null, room="";

document.querySelectorAll(".pingbtn").forEach(btn=>{
  btn.addEventListener("dragstart", e=>{
    e.dataTransfer.setData("type", btn.dataset.type);
  });
});

socket.on("state", s=>{
  state=s;
  room=s.room;
  render();
});

function render(){
  const piles=document.getElementById("piles");
  piles.innerHTML="";
  for(const p in state.piles){
    const d=document.createElement("div");
    d.className="pile";
    d.innerHTML=`<strong>${state.piles[p]}</strong>`;

    // Drop-Zone
    d.ondragover=e=>e.preventDefault();
    d.ondrop=e=>{
      const type=e.dataTransfer.getData("type");
      socket.emit("pilePing",{room,pile:p,type});
    };

    // Ping anzeigen
    const ping=state.pilePings?.[p];
    if(ping){
      const s=document.createElement("div");
      s.className="ping "+ping.type;
      s.innerText=ping.type==="have"?"ğŸ‘€":"ğŸš«";
      d.appendChild(s);
    }

    piles.appendChild(d);
  }
}
</script>
</body>
</html>
